{
    "last_node_id": 30,
    "last_link_id": 50,
    "nodes": [
        {
            "id": 100,
            "type": "Note",
            "pos": [-700, 50],
            "size": [600, 550],
            "flags": {},
            "order": 0,
            "mode": 0,
            "properties": {"text": ""},
            "widgets_values": [
                "# FreeFuse SDXL Workflow\n\n## Required Models\n\n### checkpoints/\n- sd_xl_base_1.0.safetensors\n\n### vae/ (optional)\n- sdxl_vae.safetensors (or use built-in)\n\n## LoRA Downloads (loras/)\n- harry_potter_xl.safetensors\n- daiyu_lin_xl.safetensors\n\n## Notes\n- SDXL requires ~8GB VRAM for 1024x1024\n- Uses standard CFG (7.0)\n- 30 steps recommended"
            ],
            "color": "#432",
            "bgcolor": "#653"
        },
        {
            "id": 101,
            "type": "Note",
            "pos": [-700, 650],
            "size": [600, 500],
            "flags": {},
            "order": 0,
            "mode": 0,
            "properties": {"text": ""},
            "widgets_values": [
                "# Phase 1 Parameters\n\n- steps: Total steps (match Phase 2)\n- collect_step: Step to collect attention (10)\n- collect_block: UNet block (8)\n- temperature: Softmax temp (0=auto:4000)\n- top_k_ratio: Token ratio (0.3)\n- disable_lora_phase1: Disable LoRA (true)\n- bg_scale: Background scale (0.95)\n- balance_iterations: Iterations (15)\n\n# Phase 2 Parameters\n\n- bias_scale: Negative bias (5.0)\n- positive_bias_scale: Positive bias (1.0)\n- bidirectional: Both directions (true)\n- bias_blocks: all"
            ],
            "color": "#224",
            "bgcolor": "#335"
        },
        {
            "id": 1,
            "type": "CheckpointLoaderSimple",
            "pos": [50, 100],
            "size": [315, 100],
            "flags": {},
            "order": 1,
            "mode": 0,
            "outputs": [
                {"name": "MODEL", "type": "MODEL", "links": [1], "slot_index": 0},
                {"name": "CLIP", "type": "CLIP", "links": [2], "slot_index": 1},
                {"name": "VAE", "type": "VAE", "links": [30], "slot_index": 2}
            ],
            "properties": {"Node name for S&R": "CheckpointLoaderSimple"},
            "widgets_values": ["sd_xl_base_1.0.safetensors"],
            "title": "Load SDXL Checkpoint"
        },
        {
            "id": 4,
            "type": "FreeFuseLoRALoader",
            "pos": [450, 100],
            "size": [315, 150],
            "flags": {},
            "order": 2,
            "mode": 0,
            "inputs": [
                {"name": "model", "type": "MODEL", "link": 1},
                {"name": "clip", "type": "CLIP", "link": 2},
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "link": null}
            ],
            "outputs": [
                {"name": "model", "type": "MODEL", "links": [3], "slot_index": 0},
                {"name": "clip", "type": "CLIP", "links": [4], "slot_index": 1},
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "links": [5], "slot_index": 2}
            ],
            "properties": {"Node name for S&R": "FreeFuseLoRALoader"},
            "widgets_values": ["harry_potter_xl.safetensors", "harry", 1.0, 1.0],
            "title": "LoRA 1: Harry Potter"
        },
        {
            "id": 5,
            "type": "FreeFuseLoRALoader",
            "pos": [450, 320],
            "size": [315, 150],
            "flags": {},
            "order": 3,
            "mode": 0,
            "inputs": [
                {"name": "model", "type": "MODEL", "link": 3},
                {"name": "clip", "type": "CLIP", "link": 4},
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "link": 5}
            ],
            "outputs": [
                {"name": "model", "type": "MODEL", "links": [6], "slot_index": 0},
                {"name": "clip", "type": "CLIP", "links": [7, 8, 9], "slot_index": 1},
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "links": [10], "slot_index": 2}
            ],
            "properties": {"Node name for S&R": "FreeFuseLoRALoader"},
            "widgets_values": ["daiyu_lin_xl.safetensors", "daiyu", 1.0, 1.0],
            "title": "LoRA 2: Daiyu Lin"
        },
        {
            "id": 6,
            "type": "FreeFuseConceptMap",
            "pos": [850, 100],
            "size": [380, 340],
            "flags": {},
            "order": 4,
            "mode": 0,
            "inputs": [
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "link": 10}
            ],
            "outputs": [
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "links": [11], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "FreeFuseConceptMap"},
            "widgets_values": [
                "harry",
                "harry potter, an European photorealistic style teenage wizard boy with messy black hair, round wire-frame glasses, and bright green eyes, wearing a white shirt, burgundy and gold striped tie, and dark robes",
                "daiyu",
                "daiyu_lin, a young East Asian photorealistic style woman in traditional Chinese hanfu dress, elaborate black updo hairstyle adorned with delicate white floral hairpins and ornaments, dangling red tassel earrings, soft pink and red color palette, gentle smile with knowing expression",
                "",
                "",
                "",
                "",
                true,
                "autumn leaves blurred in the background"
            ],
            "title": "Concept Mapping"
        },
        {
            "id": 20,
            "type": "PrimitiveNode",
            "pos": [850, 500],
            "size": [380, 130],
            "flags": {},
            "order": 5,
            "mode": 0,
            "outputs": [
                {"name": "STRING", "type": "STRING", "links": [35, 36], "slot_index": 0, "widget": {"name": "value"}}
            ],
            "title": "Main Prompt",
            "properties": {"Run widget replace on values": false},
            "widgets_values": [
                "Realistic photography, harry potter, an European photorealistic style teenage wizard boy with messy black hair, round wire-frame glasses, and bright green eyes, wearing a white shirt, burgundy and gold striped tie, and dark robes hugging daiyu_lin, a young East Asian photorealistic style woman in traditional Chinese hanfu dress, elaborate black updo hairstyle adorned with delicate white floral hairpins and ornaments, dangling red tassel earrings, soft pink and red color palette, gentle smile with knowing expression, autumn leaves blurred in the background, high quality, detailed"
            ]
        },
        {
            "id": 8,
            "type": "FreeFuseTokenPositions",
            "pos": [1320, 100],
            "size": [340, 130],
            "flags": {},
            "order": 6,
            "mode": 0,
            "inputs": [
                {"name": "clip", "type": "CLIP", "link": 7},
                {"name": "prompt", "type": "STRING", "link": 35, "widget": {"name": "prompt"}},
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "link": 11}
            ],
            "outputs": [
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "links": [14], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "FreeFuseTokenPositions"},
            "widgets_values": [true, true],
            "title": "Compute Token Positions"
        },
        {
            "id": 9,
            "type": "CLIPTextEncode",
            "pos": [1320, 280],
            "size": [340, 120],
            "flags": {},
            "order": 7,
            "mode": 0,
            "inputs": [
                {"name": "clip", "type": "CLIP", "link": 8},
                {"name": "text", "type": "STRING", "link": 36, "widget": {"name": "text"}}
            ],
            "outputs": [
                {"name": "CONDITIONING", "type": "CONDITIONING", "links": [16, 28], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "CLIPTextEncode"},
            "widgets_values": [""],
            "title": "Positive Conditioning"
        },
        {
            "id": 11,
            "type": "CLIPTextEncode",
            "pos": [1320, 450],
            "size": [340, 100],
            "flags": {},
            "order": 8,
            "mode": 0,
            "inputs": [
                {"name": "clip", "type": "CLIP", "link": 9}
            ],
            "outputs": [
                {"name": "CONDITIONING", "type": "CONDITIONING", "links": [38, 39], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "CLIPTextEncode"},
            "widgets_values": ["ugly, blurry, low quality, deformed"],
            "title": "Negative Conditioning"
        },
        {
            "id": 10,
            "type": "EmptyLatentImage",
            "pos": [1320, 600],
            "size": [340, 106],
            "flags": {},
            "order": 9,
            "mode": 0,
            "outputs": [
                {"name": "LATENT", "type": "LATENT", "links": [17, 22, 50], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "EmptyLatentImage"},
            "widgets_values": [1024, 1024, 1],
            "title": "Latent Image Size"
        },
        {
            "id": 12,
            "type": "FreeFusePhase1Sampler",
            "pos": [1750, 100],
            "size": [380, 450],
            "flags": {},
            "order": 10,
            "mode": 0,
            "inputs": [
                {"name": "model", "type": "MODEL", "link": 6},
                {"name": "conditioning", "type": "CONDITIONING", "link": 16},
                {"name": "neg_conditioning", "type": "CONDITIONING", "link": 38},
                {"name": "latent", "type": "LATENT", "link": 17},
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "link": 14}
            ],
            "outputs": [
                {"name": "model", "type": "MODEL", "links": [18], "slot_index": 0},
                {"name": "masks", "type": "FREEFUSE_MASKS", "links": [19, 20], "slot_index": 1},
                {"name": "mask_preview", "type": "IMAGE", "links": [21], "slot_index": 2}
            ],
            "properties": {"Node name for S&R": "FreeFusePhase1Sampler"},
            "widgets_values": [
                42,
                30,
                10,
                7.0,
                "euler",
                "normal",
                8,
                0.0,
                0.3,
                true,
                0.95,
                false,
                15
            ],
            "title": "Phase 1: Collect Masks"
        },
        {
            "id": 13,
            "type": "PreviewImage",
            "pos": [2220, 100],
            "size": [320, 280],
            "flags": {},
            "order": 11,
            "mode": 0,
            "inputs": [
                {"name": "images", "type": "IMAGE", "link": 21}
            ],
            "properties": {"Node name for S&R": "PreviewImage"},
            "title": "Phase 1 Mask Preview"
        },
        {
            "id": 15,
            "type": "FreeFuseMaskPreview",
            "pos": [2220, 420],
            "size": [320, 150],
            "flags": {},
            "order": 12,
            "mode": 0,
            "inputs": [
                {"name": "masks", "type": "FREEFUSE_MASKS", "link": 20}
            ],
            "outputs": [
                {"name": "combined_preview", "type": "IMAGE", "links": [40], "slot_index": 0},
                {"name": "individual_masks", "type": "IMAGE", "links": [41], "slot_index": 1}
            ],
            "properties": {"Node name for S&R": "FreeFuseMaskPreview"},
            "widgets_values": [512, 512, true, true],
            "title": "Detailed Mask Preview"
        },
        {
            "id": 25,
            "type": "PreviewImage",
            "pos": [2600, 420],
            "size": [260, 220],
            "flags": {},
            "order": 13,
            "mode": 0,
            "inputs": [
                {"name": "images", "type": "IMAGE", "link": 40}
            ],
            "properties": {"Node name for S&R": "PreviewImage"},
            "title": "Combined Masks"
        },
        {
            "id": 26,
            "type": "PreviewImage",
            "pos": [2600, 680],
            "size": [260, 220],
            "flags": {},
            "order": 14,
            "mode": 0,
            "inputs": [
                {"name": "images", "type": "IMAGE", "link": 41}
            ],
            "properties": {"Node name for S&R": "PreviewImage"},
            "title": "Individual Masks"
        },
        {
            "id": 14,
            "type": "FreeFuseMaskApplicator",
            "pos": [1750, 600],
            "size": [380, 320],
            "flags": {},
            "order": 15,
            "mode": 0,
            "inputs": [
                {"name": "model", "type": "MODEL", "link": 18},
                {"name": "masks", "type": "FREEFUSE_MASKS", "link": 19},
                {"name": "freefuse_data", "type": "FREEFUSE_DATA", "link": 14},
                {"name": "latent", "type": "LATENT", "link": 22}
            ],
            "outputs": [
                {"name": "model", "type": "MODEL", "links": [23], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "FreeFuseMaskApplicator"},
            "widgets_values": [true, true, 5.0, 1.0, true, true, "all"],
            "title": "Phase 2: Apply Masks"
        },
        {
            "id": 16,
            "type": "KSampler",
            "pos": [1750, 1000],
            "size": [380, 350],
            "flags": {},
            "order": 16,
            "mode": 0,
            "inputs": [
                {"name": "model", "type": "MODEL", "link": 23},
                {"name": "positive", "type": "CONDITIONING", "link": 28},
                {"name": "negative", "type": "CONDITIONING", "link": 39},
                {"name": "latent_image", "type": "LATENT", "link": 50}
            ],
            "outputs": [
                {"name": "LATENT", "type": "LATENT", "links": [24], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "KSampler"},
            "widgets_values": [42, "fixed", 30, 7.0, "euler", "normal", 1.0],
            "title": "Phase 2: Full Generation"
        },
        {
            "id": 17,
            "type": "VAEDecode",
            "pos": [2220, 1050],
            "size": [200, 50],
            "flags": {},
            "order": 17,
            "mode": 0,
            "inputs": [
                {"name": "samples", "type": "LATENT", "link": 24},
                {"name": "vae", "type": "VAE", "link": 30}
            ],
            "outputs": [
                {"name": "IMAGE", "type": "IMAGE", "links": [26], "slot_index": 0}
            ],
            "properties": {"Node name for S&R": "VAEDecode"}
        },
        {
            "id": 18,
            "type": "SaveImage",
            "pos": [2500, 950],
            "size": [400, 400],
            "flags": {},
            "order": 18,
            "mode": 0,
            "inputs": [
                {"name": "images", "type": "IMAGE", "link": 26}
            ],
            "properties": {"Node name for S&R": "SaveImage"},
            "widgets_values": ["FreeFuse/sdxl_output"],
            "title": "Final Output"
        }
    ],
    "links": [
        [1, 1, 0, 4, 0, "MODEL"],
        [2, 1, 1, 4, 1, "CLIP"],
        [3, 4, 0, 5, 0, "MODEL"],
        [4, 4, 1, 5, 1, "CLIP"],
        [5, 4, 2, 5, 2, "FREEFUSE_DATA"],
        [6, 5, 0, 12, 0, "MODEL"],
        [7, 5, 1, 8, 0, "CLIP"],
        [8, 5, 1, 9, 0, "CLIP"],
        [9, 5, 1, 11, 0, "CLIP"],
        [10, 5, 2, 6, 0, "FREEFUSE_DATA"],
        [11, 6, 0, 8, 2, "FREEFUSE_DATA"],
        [14, 8, 0, 12, 4, "FREEFUSE_DATA"],
        [16, 9, 0, 12, 1, "CONDITIONING"],
        [17, 10, 0, 12, 3, "LATENT"],
        [18, 12, 0, 14, 0, "MODEL"],
        [19, 12, 1, 14, 1, "FREEFUSE_MASKS"],
        [20, 12, 1, 15, 0, "FREEFUSE_MASKS"],
        [21, 12, 2, 13, 0, "IMAGE"],
        [22, 10, 0, 14, 3, "LATENT"],
        [23, 14, 0, 16, 0, "MODEL"],
        [24, 16, 0, 17, 0, "LATENT"],
        [26, 17, 0, 18, 0, "IMAGE"],
        [28, 9, 0, 16, 1, "CONDITIONING"],
        [30, 1, 2, 17, 1, "VAE"],
        [35, 20, 0, 8, 1, "STRING"],
        [36, 20, 0, 9, 1, "STRING"],
        [38, 11, 0, 12, 2, "CONDITIONING"],
        [39, 11, 0, 16, 2, "CONDITIONING"],
        [40, 15, 0, 25, 0, "IMAGE"],
        [41, 15, 1, 26, 0, "IMAGE"],
        [50, 10, 0, 16, 3, "LATENT"]
    ],
    "groups": [
        {"title": "1. Load Checkpoint", "bounding": [30, 50, 380, 280], "color": "#3f789e"},
        {"title": "2. Load LoRAs", "bounding": [430, 50, 380, 480], "color": "#2E8B57"},
        {"title": "3. Concept Mapping", "bounding": [830, 50, 420, 620], "color": "#88A825"},
        {"title": "4. Conditioning", "bounding": [1300, 50, 400, 700], "color": "#DAA520"},
        {"title": "5. Phase 1: Masks", "bounding": [1730, 50, 520, 500], "color": "#A8442A"},
        {"title": "6. Phase 2: Generate", "bounding": [1730, 550, 520, 850], "color": "#7B3F9E"}
    ],
    "config": {},
    "extra": {
        "ds": {"scale": 0.5, "offset": [300, 100]},
        "info": {
            "name": "FreeFuse SDXL Complete Workflow",
            "author": "FreeFuse Team",
            "version": "3.0"
        }
    },
    "version": 0.4
}
