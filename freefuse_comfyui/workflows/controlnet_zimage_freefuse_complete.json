{
  "id": "d8a126d2-fb3f-4a33-88f8-908e9dc41bc9",
  "revision": 0,
  "last_node_id": 104,
  "last_link_id": 57,
  "nodes": [
    {
      "id": 100,
      "type": "Note",
      "pos": [
        -700,
        50
      ],
      "size": [
        700,
        1100
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Z-Image Model Guide",
      "properties": {
        "text": ""
      },
      "widgets_values": [
        "# FreeFuse Z-Image-Turbo - Model & LoRA Guide\n# FreeFuse Z-Image-Turbo - 模型与LoRA指南\n\n═══════════════════════════════════════\n\n## Required Models / 所需模型\n\n### text_encoders/\n- qwen_3_4b.safetensors\n  https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/text_encoders/qwen_3_4b.safetensors\n\n### diffusion_models/\n- z_image_turbo_bf16.safetensors\n  https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/diffusion_models/z_image_turbo_bf16.safetensors\n\n### vae/\n- ae.safetensors\n  https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/vae/ae.safetensors\n\n### loras/\n- Jinx_Arcane_zit.safetensors\n  https://huggingface.co/lsmpp/freefuse_example_loras/resolve/main/Jinx_Arcane_zit.safetensors?download=true\n- skeletor_zit.safetensors\n  https://huggingface.co/lsmpp/freefuse_example_loras/resolve/main/skeletor_zit.safetensors?download=true\n\nPlace these under ComfyUI/models/loras/.\n将以上LoRA放在 ComfyUI/models/loras/ 目录。\n\n═══════════════════════════════════════\n\n## Important Notes / 重要提示\n- This workflow uses two-phase FreeFuse (mask collect -> masked generation).\n- 本工作流使用两阶段FreeFuse（掩码收集 -> 掩码生成）。\n- Z-Image uses 16-channel latent, so this workflow uses EmptySD3LatentImage.\n- Z-Image 使用16通道latent，因此使用 EmptySD3LatentImage。\n- Keep Phase1 and Phase2 steps/sampler/scheduler consistent.\n- 阶段1与阶段2的步数、采样器和调度器应保持一致。"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 2,
      "type": "CLIPLoader",
      "pos": [
        50,
        250
      ],
      "size": [
        315,
        106
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "slot_index": 0,
          "links": [
            2
          ]
        }
      ],
      "title": "Load Qwen3 Text Encoder",
      "properties": {
        "Node name for S&R": "CLIPLoader",
        "cnr_id": "comfy-core",
        "models": [
          {
            "name": "qwen_3_4b.safetensors",
            "url": "https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/text_encoders/qwen_3_4b.safetensors",
            "directory": "text_encoders"
          }
        ]
      },
      "widgets_values": [
        "qwen_3_4b.safetensors",
        "lumina2",
        "default"
      ]
    },
    {
      "id": 13,
      "type": "PreviewImage",
      "pos": [
        2220,
        100
      ],
      "size": [
        320,
        280
      ],
      "flags": {},
      "order": 20,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 21
        }
      ],
      "outputs": [],
      "title": "Phase 1 Mask Preview",
      "properties": {
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 15,
      "type": "FreeFuseMaskPreview",
      "pos": [
        2220,
        420
      ],
      "size": [
        320,
        150
      ],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {
          "name": "masks",
          "type": "FREEFUSE_MASKS",
          "link": 20
        }
      ],
      "outputs": [
        {
          "name": "combined_preview",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            40
          ]
        },
        {
          "name": "individual_masks",
          "type": "IMAGE",
          "slot_index": 1,
          "links": [
            41
          ]
        }
      ],
      "title": "Detailed Mask Preview",
      "properties": {
        "Node name for S&R": "FreeFuseMaskPreview"
      },
      "widgets_values": [
        512,
        512,
        true,
        true
      ]
    },
    {
      "id": 25,
      "type": "PreviewImage",
      "pos": [
        2600,
        420
      ],
      "size": [
        260,
        246
      ],
      "flags": {},
      "order": 21,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 40
        }
      ],
      "outputs": [],
      "title": "Combined Masks",
      "properties": {
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 26,
      "type": "PreviewImage",
      "pos": [
        2600,
        680
      ],
      "size": [
        260,
        246
      ],
      "flags": {},
      "order": 22,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 41
        }
      ],
      "outputs": [],
      "title": "Individual Masks",
      "properties": {
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 14,
      "type": "FreeFuseMaskApplicator",
      "pos": [
        1725.838055721599,
        904.5637591001968
      ],
      "size": [
        380,
        320
      ],
      "flags": {},
      "order": 23,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 18
        },
        {
          "name": "masks",
          "type": "FREEFUSE_MASKS",
          "link": 19
        },
        {
          "name": "freefuse_data",
          "type": "FREEFUSE_DATA",
          "link": 14
        },
        {
          "name": "latent",
          "shape": 7,
          "type": "LATENT",
          "link": 22
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            23
          ]
        }
      ],
      "title": "Phase 2: Apply Masks",
      "properties": {
        "Node name for S&R": "FreeFuseMaskApplicator"
      },
      "widgets_values": [
        true,
        true,
        4,
        2,
        true,
        true,
        "all"
      ]
    },
    {
      "id": 17,
      "type": "VAEDecode",
      "pos": [
        2220,
        1050
      ],
      "size": [
        200,
        50
      ],
      "flags": {},
      "order": 25,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 24
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 30
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            26
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 18,
      "type": "SaveImage",
      "pos": [
        2500,
        950
      ],
      "size": [
        400,
        400
      ],
      "flags": {},
      "order": 26,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 26
        }
      ],
      "outputs": [],
      "title": "Final Output",
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": [
        "FreeFuse/zimage_turbo_output"
      ]
    },
    {
      "id": 101,
      "type": "Note",
      "pos": [
        -694.8444062850768,
        1195.91015625
      ],
      "size": [
        700,
        2200
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Z-Image Parameters",
      "properties": {
        "text": ""
      },
      "widgets_values": [
        "# FreeFuse Z-Image-Turbo - Parameter Guide\n# FreeFuse Z-Image-Turbo - 参数说明\n\nRecommended defaults used in this workflow:\n- seed: 77\n- steps: 12\n- collect_step: 3\n- cfg: 1.0\n- sampler/scheduler: euler + simple\n- collect_block: 18\n- temperature: 0 (auto)\n- top_k_ratio: 0.1\n- disable_lora_phase1: true\n- use_morphological_cleaning: true\n\nMask applicator:\n- enable_token_masking: true\n- enable_attention_bias: true\n- bias_scale: 4.0\n- positive_bias_scale: 2.0\n- bidirectional: true\n- use_positive_bias: true\n- bias_blocks: all\n\nPrompt alignment for Z-Image:\n- FreeFuseTokenPositions will internally prepend Lumina2 system prompt.\n- Conditioning uses StringConcatenate to prepend the same system prompt before CLIPTextEncode.\n- This keeps token positions aligned with Z-Image text embeddings."
      ],
      "color": "#224",
      "bgcolor": "#335"
    },
    {
      "id": 10,
      "type": "EmptySD3LatentImage",
      "pos": [
        1731.4693600088444,
        971.0201786934185
      ],
      "size": [
        340,
        106
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            17,
            22,
            50
          ]
        }
      ],
      "title": "Latent Image Size",
      "properties": {
        "Node name for S&R": "EmptySD3LatentImage"
      },
      "widgets_values": [
        1024,
        1024,
        1
      ]
    },
    {
      "id": 11,
      "type": "CLIPTextEncode",
      "pos": [
        1324.9805582818449,
        496.89331738311284
      ],
      "size": [
        340,
        100
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 9
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            38,
            39
          ]
        }
      ],
      "title": "Negative Conditioning",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "You are an assistant designed to generate superior images with the superior degree of image-text alignment based on textual prompts or user prompts. <Prompt Start> "
      ]
    },
    {
      "id": 21,
      "type": "StringConcatenate",
      "pos": [
        1318.3774087009022,
        161.73855320008826
      ],
      "size": [
        340,
        166
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "string_b",
          "type": "STRING",
          "widget": {
            "name": "string_b"
          },
          "link": 36
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [
            37
          ]
        }
      ],
      "title": "Lumina2 Prompt Wrapper",
      "properties": {
        "Node name for S&R": "StringConcatenate",
        "cnr_id": "comfy-core"
      },
      "widgets_values": [
        "You are an assistant designed to generate superior images with the superior degree of image-text alignment based on textual prompts or user prompts. <Prompt Start> ",
        "A picture of two characters, a starry night scene with northern lights in background: The first character is Jinx_Arcane, a young woman with long blue hair in a loose braid and bright blue eyes, wearing a cropped halter top, gloves, striped pants with belts, and visible tattoos. The second character is Skeletor in purple hooded cloak flexing muscular blue arms triumphantly, skull face grinning menacingly, cartoon animation style, Masters of the Universe character, vibrant purple and blue color scheme.",
        ""
      ]
    },
    {
      "id": 9,
      "type": "CLIPTextEncode",
      "pos": [
        1321.8508922978588,
        383.2295583311953
      ],
      "size": [
        340,
        120
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 8
        },
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 37
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            16,
            28
          ]
        }
      ],
      "title": "Positive Conditioning",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "You are an assistant designed to generate superior images with the superior degree of image-text alignment based on textual prompts or user prompts. <Prompt Start> A picture of two characters, a starry night scene with northern lights in background: The first character is Jinx_Arcane, a young woman with long blue hair in a loose braid and bright blue eyes, wearing a cropped halter top, gloves, striped pants with belts, and visible tattoos and the second character is Skeletor in purple hooded cloak flexing muscular blue arms triumphantly, skull face grinning menacingly, cartoon animation style, Masters of the Universe character, vibrant purple and blue color scheme"
      ]
    },
    {
      "id": 8,
      "type": "FreeFuseTokenPositions",
      "pos": [
        1319.7705847777625,
        25.931757922826517
      ],
      "size": [
        340,
        156
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 7
        },
        {
          "name": "freefuse_data",
          "type": "FREEFUSE_DATA",
          "link": 11
        },
        {
          "name": "prompt",
          "type": "STRING",
          "widget": {
            "name": "prompt"
          },
          "link": 35
        }
      ],
      "outputs": [
        {
          "name": "freefuse_data",
          "type": "FREEFUSE_DATA",
          "slot_index": 0,
          "links": [
            14
          ]
        }
      ],
      "title": "Compute Token Positions",
      "properties": {
        "Node name for S&R": "FreeFuseTokenPositions"
      },
      "widgets_values": [
        "A picture of two characters, a starry night scene with northern lights in background: The first character is Jinx_Arcane, a young woman with long blue hair in a loose braid and bright blue eyes, wearing a cropped halter top, gloves, striped pants with belts, and visible tattoos. The second character is Skeletor in purple hooded cloak flexing muscular blue arms triumphantly, skull face grinning menacingly, cartoon animation style, Masters of the Universe character, vibrant purple and blue color scheme.",
        true,
        true
      ]
    },
    {
      "id": 6,
      "type": "FreeFuseConceptMap",
      "pos": [
        854.0175259768482,
        84.4035412604034
      ],
      "size": [
        380,
        424.0000000000001
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "freefuse_data",
          "shape": 7,
          "type": "FREEFUSE_DATA",
          "link": 10
        }
      ],
      "outputs": [
        {
          "name": "freefuse_data",
          "type": "FREEFUSE_DATA",
          "slot_index": 0,
          "links": [
            11
          ]
        }
      ],
      "title": "Concept Mapping",
      "properties": {
        "Node name for S&R": "FreeFuseConceptMap"
      },
      "widgets_values": [
        "jinx",
        "Jinx_Arcane, a young woman with long blue hair in a loose braid and bright blue eyes, wearing a cropped halter top, gloves, striped pants with belts, and visible tattoos",
        "skeleton",
        "Skeletor in purple hooded cloak flexing muscular blue arms triumphantly, skull face grinning menacingly, cartoon animation style, Masters of the Universe character, vibrant purple and blue color scheme",
        "",
        "",
        "",
        "",
        true,
        "a starry night scene with northern lights"
      ]
    },
    {
      "id": 3,
      "type": "VAELoader",
      "pos": [
        50,
        450
      ],
      "size": [
        315,
        58
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "slot_index": 0,
          "links": [
            30,
            53
          ]
        }
      ],
      "title": "Load Z-Image VAE",
      "properties": {
        "Node name for S&R": "VAELoader",
        "cnr_id": "comfy-core",
        "models": [
          {
            "name": "ae.safetensors",
            "url": "https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/vae/ae.safetensors",
            "directory": "vae"
          }
        ]
      },
      "widgets_values": [
        "ae.safetensors"
      ]
    },
    {
      "id": 1,
      "type": "UNETLoader",
      "pos": [
        50,
        100
      ],
      "size": [
        315,
        82
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            1
          ]
        }
      ],
      "title": "Load Z-Image UNET",
      "properties": {
        "Node name for S&R": "UNETLoader",
        "cnr_id": "comfy-core",
        "models": [
          {
            "name": "z_image_turbo_bf16.safetensors",
            "url": "https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/diffusion_models/z_image_turbo_bf16.safetensors",
            "directory": "diffusion_models"
          }
        ]
      },
      "widgets_values": [
        "z_image_turbo_bf16.safetensors",
        "default"
      ]
    },
    {
      "id": 20,
      "type": "PrimitiveNode",
      "pos": [
        857.8709857141362,
        544.484853262177
      ],
      "size": [
        380,
        130
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "widget": {
            "name": "prompt"
          },
          "slot_index": 0,
          "links": [
            35,
            36
          ]
        }
      ],
      "title": "Main Prompt (User Prompt)",
      "properties": {
        "Run widget replace on values": false
      },
      "widgets_values": [
        "A picture of two characters, a starry night scene with northern lights in background: The first character is Jinx_Arcane, a young woman with long blue hair in a loose braid and bright blue eyes, wearing a cropped halter top, gloves, striped pants with belts, and visible tattoos. The second character is Skeletor in purple hooded cloak flexing muscular blue arms triumphantly, skull face grinning menacingly, cartoon animation style, Masters of the Universe character, vibrant purple and blue color scheme."
      ]
    },
    {
      "id": 7,
      "type": "ModelSamplingAuraFlow",
      "pos": [
        856.2549860053797,
        813.0731950533174
      ],
      "size": [
        315,
        60
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 56
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            51
          ]
        }
      ],
      "title": "Model Sampling Patch (AuraFlow)",
      "properties": {
        "Node name for S&R": "ModelSamplingAuraFlow",
        "cnr_id": "comfy-core"
      },
      "widgets_values": [
        3
      ]
    },
    {
      "id": 102,
      "type": "ModelPatchLoader",
      "pos": [
        472.0765671972242,
        522.1887577496524
      ],
      "size": [
        270,
        58
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL_PATCH",
          "type": "MODEL_PATCH",
          "links": [
            52
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "ModelPatchLoader"
      },
      "widgets_values": [
        "Z-Image-Turbo-Fun-Controlnet-Union.safetensors"
      ]
    },
    {
      "id": 4,
      "type": "FreeFuseLoRALoader",
      "pos": [
        450,
        100
      ],
      "size": [
        315,
        170
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 1
        },
        {
          "name": "clip",
          "type": "CLIP",
          "link": 2
        },
        {
          "name": "freefuse_data",
          "shape": 7,
          "type": "FREEFUSE_DATA",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            3
          ]
        },
        {
          "name": "clip",
          "type": "CLIP",
          "slot_index": 1,
          "links": [
            4
          ]
        },
        {
          "name": "freefuse_data",
          "type": "FREEFUSE_DATA",
          "slot_index": 2,
          "links": [
            5
          ]
        }
      ],
      "title": "LoRA 1: Jinx",
      "properties": {
        "Node name for S&R": "FreeFuseLoRALoader"
      },
      "widgets_values": [
        "Jinx_Arcane_zit.safetensors",
        "jinx",
        0.5,
        0.7
      ]
    },
    {
      "id": 5,
      "type": "FreeFuseLoRALoader",
      "pos": [
        450,
        320
      ],
      "size": [
        315,
        170
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 3
        },
        {
          "name": "clip",
          "type": "CLIP",
          "link": 4
        },
        {
          "name": "freefuse_data",
          "shape": 7,
          "type": "FREEFUSE_DATA",
          "link": 5
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            55
          ]
        },
        {
          "name": "clip",
          "type": "CLIP",
          "slot_index": 1,
          "links": [
            7,
            8,
            9
          ]
        },
        {
          "name": "freefuse_data",
          "type": "FREEFUSE_DATA",
          "slot_index": 2,
          "links": [
            10
          ]
        }
      ],
      "title": "LoRA 2: Skeletor",
      "properties": {
        "Node name for S&R": "FreeFuseLoRALoader"
      },
      "widgets_values": [
        "skeletor_zit.safetensors",
        "skeleton",
        0.5,
        0.7
      ]
    },
    {
      "id": 12,
      "type": "FreeFusePhase1Sampler",
      "pos": [
        1750,
        100
      ],
      "size": [
        380,
        686
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 51
        },
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 16
        },
        {
          "name": "neg_conditioning",
          "type": "CONDITIONING",
          "link": 38
        },
        {
          "name": "latent",
          "type": "LATENT",
          "link": 17
        },
        {
          "name": "freefuse_data",
          "type": "FREEFUSE_DATA",
          "link": 14
        },
        {
          "name": "sigmas",
          "shape": 7,
          "type": "SIGMAS",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            18
          ]
        },
        {
          "name": "masks",
          "type": "FREEFUSE_MASKS",
          "slot_index": 1,
          "links": [
            19,
            20
          ]
        },
        {
          "name": "mask_preview",
          "type": "IMAGE",
          "slot_index": 2,
          "links": [
            21
          ]
        }
      ],
      "title": "Phase 1: Collect Masks",
      "properties": {
        "Node name for S&R": "FreeFusePhase1Sampler"
      },
      "widgets_values": [
        999,
        12,
        12,
        2,
        1,
        "euler",
        "simple",
        18,
        "output_early ★ (recommended)",
        3,
        0,
        0.1,
        true,
        0.95,
        true,
        15,
        0.01,
        0.00004,
        0.00004,
        0.2,
        0,
        0,
        1.3
      ]
    },
    {
      "id": 16,
      "type": "KSampler",
      "pos": [
        1725.838055721599,
        1304.5637591001973
      ],
      "size": [
        380,
        350
      ],
      "flags": {},
      "order": 24,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 23
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 28
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 39
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 50
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            24
          ]
        }
      ],
      "title": "Phase 2: Full Generation",
      "properties": {
        "Node name for S&R": "KSampler"
      },
      "widgets_values": [
        999,
        "fixed",
        9,
        1,
        "euler",
        "simple",
        1
      ]
    },
    {
      "id": 103,
      "type": "QwenImageDiffsynthControlnet",
      "pos": [
        463.51133194823825,
        627.5103361365116
      ],
      "size": [
        307.5689453125,
        138
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 55
        },
        {
          "name": "model_patch",
          "type": "MODEL_PATCH",
          "link": 52
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 53
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": 57
        },
        {
          "name": "mask",
          "shape": 7,
          "type": "MASK",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            56
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "QwenImageDiffsynthControlnet"
      },
      "widgets_values": [
        0.9
      ]
    },
    {
      "id": 104,
      "type": "LoadImage",
      "pos": [
        54.99442231198819,
        644.968801307035
      ],
      "size": [
        282.798828125,
        314
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            57
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": [
        "pose.png",
        "image"
      ]
    }
  ],
  "links": [
    [
      1,
      1,
      0,
      4,
      0,
      "MODEL"
    ],
    [
      2,
      2,
      0,
      4,
      1,
      "CLIP"
    ],
    [
      3,
      4,
      0,
      5,
      0,
      "MODEL"
    ],
    [
      4,
      4,
      1,
      5,
      1,
      "CLIP"
    ],
    [
      5,
      4,
      2,
      5,
      2,
      "FREEFUSE_DATA"
    ],
    [
      7,
      5,
      1,
      8,
      0,
      "CLIP"
    ],
    [
      8,
      5,
      1,
      9,
      0,
      "CLIP"
    ],
    [
      9,
      5,
      1,
      11,
      0,
      "CLIP"
    ],
    [
      10,
      5,
      2,
      6,
      0,
      "FREEFUSE_DATA"
    ],
    [
      11,
      6,
      0,
      8,
      1,
      "FREEFUSE_DATA"
    ],
    [
      14,
      8,
      0,
      12,
      4,
      "FREEFUSE_DATA"
    ],
    [
      16,
      9,
      0,
      12,
      1,
      "CONDITIONING"
    ],
    [
      17,
      10,
      0,
      12,
      3,
      "LATENT"
    ],
    [
      18,
      12,
      0,
      14,
      0,
      "MODEL"
    ],
    [
      19,
      12,
      1,
      14,
      1,
      "FREEFUSE_MASKS"
    ],
    [
      20,
      12,
      1,
      15,
      0,
      "FREEFUSE_MASKS"
    ],
    [
      21,
      12,
      2,
      13,
      0,
      "IMAGE"
    ],
    [
      22,
      10,
      0,
      14,
      3,
      "LATENT"
    ],
    [
      23,
      14,
      0,
      16,
      0,
      "MODEL"
    ],
    [
      24,
      16,
      0,
      17,
      0,
      "LATENT"
    ],
    [
      26,
      17,
      0,
      18,
      0,
      "IMAGE"
    ],
    [
      28,
      9,
      0,
      16,
      1,
      "CONDITIONING"
    ],
    [
      30,
      3,
      0,
      17,
      1,
      "VAE"
    ],
    [
      35,
      20,
      0,
      8,
      2,
      "STRING"
    ],
    [
      36,
      20,
      0,
      21,
      0,
      "STRING"
    ],
    [
      37,
      21,
      0,
      9,
      1,
      "STRING"
    ],
    [
      38,
      11,
      0,
      12,
      2,
      "CONDITIONING"
    ],
    [
      39,
      11,
      0,
      16,
      2,
      "CONDITIONING"
    ],
    [
      40,
      15,
      0,
      25,
      0,
      "IMAGE"
    ],
    [
      41,
      15,
      1,
      26,
      0,
      "IMAGE"
    ],
    [
      50,
      10,
      0,
      16,
      3,
      "LATENT"
    ],
    [
      51,
      7,
      0,
      12,
      0,
      "MODEL"
    ],
    [
      52,
      102,
      0,
      103,
      1,
      "MODEL_PATCH"
    ],
    [
      53,
      3,
      0,
      103,
      2,
      "VAE"
    ],
    [
      55,
      5,
      0,
      103,
      0,
      "MODEL"
    ],
    [
      56,
      103,
      0,
      7,
      0,
      "MODEL"
    ],
    [
      57,
      104,
      0,
      103,
      3,
      "IMAGE"
    ]
  ],
  "groups": [
    {
      "id": 1,
      "title": "1. Load Models",
      "bounding": [
        30,
        50,
        380,
        520
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 2,
      "title": "2. Load LoRAs + Sampling Patch",
      "bounding": [
        430,
        50,
        385.55105689755555,
        744.7383045006369
      ],
      "color": "#2E8B57",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 3,
      "title": "3. Concept Mapping",
      "bounding": [
        830,
        50,
        420,
        620
      ],
      "color": "#88A825",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 4,
      "title": "4. Conditioning (Lumina2)",
      "bounding": [
        1300,
        50,
        430,
        760
      ],
      "color": "#DAA520",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 5,
      "title": "5. Phase 1: Masks",
      "bounding": [
        1730,
        50,
        520,
        500
      ],
      "color": "#A8442A",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 6,
      "title": "6. Phase 2: Generate",
      "bounding": [
        1705.838055721599,
        854.5637591001968,
        520,
        850
      ],
      "color": "#7B3F9E",
      "font_size": 24,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.6313214751590519,
      "offset": [
        553.3508820446448,
        -179.08093235624915
      ]
    },
    "info": {
      "name": "FreeFuse Z-Image-Turbo Complete Workflow",
      "description": "Two-phase FreeFuse workflow for Z-Image-Turbo with multi-LoRA composition. Uses UNETLoader + CLIPLoader(lumina2) + VAE, FreeFuse Phase1/Phase2 nodes, and Lumina2 prompt wrapping for token alignment.",
      "author": "FreeFuse Team",
      "version": "1.0",
      "notes": "For Z-Image token alignment, conditioning prompt is wrapped as 'SYSTEM_PROMPT <Prompt Start> user_prompt'. Keep Phase1 and Phase2 sampling settings consistent.",
      "models": {
        "text_encoders": [
          {
            "name": "qwen_3_4b.safetensors",
            "url": "https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/text_encoders/qwen_3_4b.safetensors"
          }
        ],
        "diffusion_models": [
          {
            "name": "z_image_turbo_bf16.safetensors",
            "url": "https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/diffusion_models/z_image_turbo_bf16.safetensors"
          }
        ],
        "vae": [
          {
            "name": "ae.safetensors",
            "url": "https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/vae/ae.safetensors"
          }
        ],
        "loras": [
          {
            "name": "Jinx_Arcane_zit.safetensors",
            "note": "Z-Image LoRA for Jinx concept",
            "url": "https://huggingface.co/lsmpp/freefuse_example_loras/resolve/main/Jinx_Arcane_zit.safetensors?download=true"
          },
          {
            "name": "skeletor_zit.safetensors",
            "note": "Z-Image LoRA for Skeletor concept",
            "url": "https://huggingface.co/lsmpp/freefuse_example_loras/resolve/main/skeletor_zit.safetensors?download=true"
          }
        ]
      }
    },
    "workflowRendererVersion": "LG",
    "frontendVersion": "1.37.11"
  },
  "version": 0.4
}